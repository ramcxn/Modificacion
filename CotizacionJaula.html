<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Cotización - Talleres Barrera</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"/>
  <link rel="stylesheet" href="https://ramcxn.github.io/Modificacion/cotizacion.css?v=4"/>
  <style>
    @media print {
      body { font-size: 10px; }
      .section, .header { padding: 10px; margin-bottom: 5px; }
      .actions-bar, .vendor-only { display: none !important; }
      .info-table td, .cost-table th, .cost-table td { padding: 3px; }
      .logo { width: 100px !important; }
    }
    .info-table, .cost-table, .bank-table,
    .header, .footer-logo-container, .section, .image-container, .reference-image {
      page-break-inside: avoid;
      break-inside: avoid;
    }
    .actions-bar { display: flex; gap: 8px; margin-bottom: 12px; flex-wrap: wrap; }
    .action-button { display:inline-flex; align-items:center; gap:8px; border:0; background:#0f766e; color:#fff; padding:8px 12px; border-radius:8px; cursor:pointer; }
    .action-button.secondary { background:#1f2937; }
    .vendor-only{background:#f9fafb;border:1px dashed #d1d5db;border-radius:8px;padding:10px;margin:10px 0}
    .vendor-only .row{display:flex;gap:8px;flex-wrap:wrap;align-items:center}
    .vendor-only label{font-weight:600}
    .vendor-only input,.vendor-only select{padding:6px 8px;border:1px solid #d1d5db;border-radius:6px}
    .vendor-only button{border:0;background:#0f766e;color:#fff;padding:8px 12px;border-radius:8px;cursor:pointer}
    .vendor-only button.secondary{background:#6b7280}
  </style>
</head>
<body>
  <div class="container" id="cotizacion-root">
    <div class="actions-bar no-pdf">
      <button class="action-button" onclick="window.print()">
        <i class="fas fa-print"></i> Imprimir
      </button>
      <button class="action-button" onclick="downloadPDF()">
        <i class="fas fa-file-pdf"></i> Descargar PDF
      </button>
      <button class="action-button secondary" onclick="sharePDFByEmail()">
        <i class="fas fa-paper-plane"></i> Enviar PDF por correo
      </button>
    </div>

    <div class="header">
      <div class="header-info">
        <h1>COTIZACIÓN</h1>
        <h2>TALLERES BARRERA S.A. DE C.V.</h2>
        <p><strong>Dirección:</strong> Industria Automotriz #126, Col. Parque Industrial, CP 67735, Linares N.L. México</p>
        <p><strong>Teléfono:</strong> <span id="telefonoContacto"></span></p>
        <p><strong>Correo:</strong> <span id="correoContacto"></span></p>
        <p><strong>RFC:</strong> TBA7504018B4</p>
      </div>
      <img id="logoPrincipal"
           src="https://www.appsheet.com:443/fsimage.png?appid=15ab7ef8-4923-40f5-80ca-3607e9850805&datasource=google&filename=DocId%3D1ON0AOw6aLouPB4hLD4HSPHQrMyYHFX5x&signature=47171ea295d0c06dc250337a646296a67b31c22191c59f9869bf63a365b8ae49&tableprovider=google&userid=1254688"
           alt="Logo de Talleres Barrera"
           class="logo"
           onerror="(function(img){try{const p=new URLSearchParams(location.search);const alt=p.get('logo');if(alt){img.src=alt;}}catch(e){}})(this)"/>
    </div>

    <p>Por medio de la presente, <strong>TALLERES BARRERA S.A. DE C.V.</strong> agradece su interés en nuestros productos. A continuación, se presenta la cotización detallada para la fabricación de su remolque, incluyendo especificaciones, costos y términos de pago.</p>

    <div class="section">
      <h3 class="section-title">Información del Cliente y General</h3>
      <table class="info-table">
        <tr><td>Fecha de Cotización:</td><td><span id="fechaCotizacion"></span></td></tr>
        <tr><td>Cliente:</td><td><span id="cliente"></span></td></tr>
        <tr><td>Dirección del Cliente:</td><td><span id="direccionCliente"></span></td></tr>
        <tr><td>RFC del Cliente:</td><td><span id="rfcCliente"></span></td></tr>
        <tr><td>Tipo de Unidad:</td><td><span id="tipoUnidad"></span></td></tr>
        <tr><td>Realizado por (Vendedor):</td><td><span id="realizadoPor"></span></td></tr>
      </table>
    </div>

    <div class="section">
      <h3 class="section-title">Especificaciones Generales</h3>
      <table class="info-table">
        <tr><td>Color Primario:</td><td><span id="colorPrimario"></span></td></tr>
        <tr><td>Color Secundario:</td><td><span id="colorSecundario"></span></td></tr>
        <tr><td>Suspensión:</td><td><span id="suspension"></span> (<span id="cantSuspensiones"></span> piezas)</td></tr>
        <tr><td>Retráctil de Eje:</td><td><span id="retractilEje"></span></td></tr>
        <tr><td>Ejes:</td><td><span id="ejes"></span></td></tr>
        <tr><td>Distancia entre Ejes:</td><td><span id="distanciaEjes"></span></td></tr>
        <tr><td>Personalización de Viga:</td><td><span id="personalizacionViga"></span></td></tr>
        <tr><td>Faldón:</td><td><span id="faldon"></span></td></tr>
        <tr><td>Perno Rey:</td><td><span id="pernoRey"></span></td></tr>
        <tr><td>Portallantas:</td><td><span id="portallantas"></span></td></tr>
      </table>
    </div>

    <div class="section">
      <h3 class="section-title">Carrocería y Estructura</h3>
      <table class="info-table">
        <tr><td>Dimensiones:</td><td><span id="dimensiones"></span></td></tr>
        <tr><td>Tipo de Redila:</td><td><span id="tipoRedila"></span></td></tr>
        <tr><td>Secciones:</td><td><span id="secciones"></span></td></tr>
        <tr><td>Puertas Laterales:</td><td><span id="puertasLaterales"></span></td></tr>
        <tr><td>Compuerta al Piso:</td><td><span id="compAlPiso"></span></td></tr>
        <tr><td>Compuerta Trasera:</td><td><span id="compAtras"></span></td></tr>
        <tr><td>Tipo de Arco:</td><td><span id="tipoArco"></span></td></tr>
        <tr><td>Piso de Madera:</td><td><span id="pisoMadera"></span></td></tr>
        <tr><td>Piso Laminado:</td><td><span id="pisoLaminado"></span></td></tr>
        <tr><td>Caballete:</td><td><span id="caballete"></span></td></tr>
        <tr><td>Tubos Interiores:</td><td><span id="tubosInteriores"></span></td></tr>
        <tr><td>Barrote Lateral:</td><td><span id="barroteLateral"></span></td></tr>
        <tr><td>Compuerta a los Lados:</td><td><span id="compuertaLados"></span></td></tr>
        <tr><td>Cerrojo de Puertas Traseras:</td><td><span id="cerrojoPuertas"></span></td></tr>
        <tr><td>Sistema de Lona:</td><td><span id="sistemaLona"></span></td></tr>
        <tr><td>Luz de Placa:</td><td><span id="luzPlaca"></span></td></tr>
      </table>
    </div>

    <div class="section">
      <h3 class="section-title">Accesorios</h3>
      <table class="info-table">
        <tr><td>Rines:</td><td><span id="rines"></span> (<span id="cantRines"></span> piezas)</td></tr>
        <tr><td>Llantas:</td><td><span id="llantas"></span> (<span id="cantLlantas"></span> piezas)</td></tr>
        <tr><td>Frenos:</td><td><span id="frenos"></span></td></tr>
        <tr><td>Juego de Patines:</td><td><span id="juegoPatines"></span> (<span id="cantPatines"></span> piezas)</td></tr>
        <tr><td>Caja de Herramientas:</td><td><span id="cajaHerramientas"></span></td></tr>
        <tr><td>Lodera Delantera:</td><td><span id="loderaDelantera"></span></td></tr>
        <tr><td>Lodera Trasera:</td><td><span id="loderaTrasera"></span></td></tr>
        <tr><td>Manivelas de Patín:</td><td><span id="manivelasPatin"></span></td></tr>
        <tr><td>Direccionales:</td><td><span id="direccionales"></span></td></tr>
        <tr><td>Plafones:</td><td><span id="plafones"></span></td></tr>
      </table>
    </div>

    <div class="section">
      <h3 class="section-title">Imágenes de Referencia</h3>
      <div class="image-container" id="imagenes-container"></div>
    </div>

    <!-- Ajuste de precio manual (no se imprime ni sale en PDF) -->
    <div class="section vendor-only no-pdf">
      <h3 class="section-title">Ajuste de precio manual (solo vendedor)</h3>
      <div class="row">
        <label for="ajuste
